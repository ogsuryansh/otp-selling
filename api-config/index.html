<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Configuration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#667eea',
                        secondary: '#764ba2',
                    }
                }
            }
        }
    </script>
    <style>
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 1rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-grid {
            display: grid;
            gap: 1.5rem;
        }
        
        /* Required field indicator */
        .required-field::after {
            content: ' *';
            color: #dc3545;
            font-weight: 700;
        }
        
        /* Form validation states */
        .form-input:invalid {
            border-color: #dc3545;
            background: #fff5f5;
        }
        
        .form-input:valid {
            border-color: #28a745;
            background: #fff;
        }
        
        /* Enhanced form section styling */
        .form-section:hover {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
            transition: all 0.3s ease;
        }
        
        .form-section {
            background: #f8f9fa;
            border-radius: 0.75rem;
            padding: 1.5rem;
            border: 1px solid #e9ecef;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .form-section h3 {
            color: #333;
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 0.5rem;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-label {
            display: block;
            color: #333;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #dee2e6;
            border-radius: 0.5rem;
            background: #fff;
            color: #333;
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: #fff;
        }
        
        .form-input::placeholder {
            color: #6c757d;
        }
        
        .form-select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #dee2e6;
            border-radius: 0.5rem;
            background: #fff;
            color: #333;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .form-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: #fff;
        }
        
        .form-select option {
            background: #fff;
            color: #333;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 0.5rem;
            border: 1px solid #e9ecef;
        }
        
        .checkbox-input {
            width: 1.25rem;
            height: 1.25rem;
            accent-color: #667eea;
        }
        
        .checkbox-label {
            color: #333;
            font-size: 0.875rem;
            cursor: pointer;
            font-weight: 500;
        }
        
        .help-text {
            color: #6c757d;
            font-size: 0.75rem;
            margin-top: 0.25rem;
            font-style: italic;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            border: 2px solid #6c757d;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
            border-color: #5a6268;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);
        }
        
        .api-list {
            display: grid;
            gap: 1rem;
        }
        
        .api-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .api-card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .api-status {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .status-active {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }
        
        .status-inactive {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .status-testing {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }
        
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                margin: 1rem;
                max-height: 95vh;
            }
        }
    </style>
</head>
<body class="gradient-bg min-h-screen text-gray-800">
    <div class="container mx-auto px-4 py-6 max-w-6xl">
        <!-- Header -->
        <div class="glass rounded-2xl p-6 mb-6 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-white mb-2">üîå API Configuration</h1>
            <p class="text-gray-200 mb-4">Connect and configure your number server APIs</p>
            
            <!-- Navigation -->
            <div class="flex flex-wrap justify-center gap-3">
                <a href="/" class="glass px-4 py-2 rounded-lg text-white hover:bg-white/20 transition-all duration-300 text-sm font-medium">
                    üè† Home
                </a>
                <a href="/admin" class="glass px-4 py-2 rounded-lg text-white hover:bg-white/20 transition-all duration-300 text-sm font-medium">
                    ‚öôÔ∏è Admin
                </a>
                <a href="/servers" class="glass px-4 py-2 rounded-lg text-white hover:bg-white/20 transition-all duration-300 text-sm font-medium">
                    üñ•Ô∏è Servers
                </a>
            </div>
        </div>

        <!-- API Configuration Section -->
        <div class="glass rounded-xl p-6 mb-6">
            <div class="flex flex-col md:flex-row justify-between items-center mb-4">
                <h3 class="text-2xl font-semibold text-white mb-4 md:mb-0">Dynamic SMS Service API Setup</h3>
                <button onclick="openApiConfigModal()" class="btn-primary">
                    ‚ûï Add New API
                </button>
            </div>
            

            
            <!-- API Statistics -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <div class="glass rounded-xl p-4 text-center hover:scale-105 transition-transform duration-300">
                    <div class="text-2xl mb-2">üîå</div>
                    <div class="text-2xl font-bold text-white" id="totalApis">-</div>
                    <div class="text-gray-300 text-sm">Total APIs</div>
                </div>
                
                <div class="glass rounded-xl p-4 text-center hover:scale-105 transition-transform duration-300">
                    <div class="text-2xl mb-2">üü¢</div>
                    <div class="text-2xl font-bold text-white" id="activeApis">-</div>
                    <div class="text-gray-300 text-sm">Active APIs</div>
                </div>
                
                <div class="glass rounded-xl p-4 text-center hover:scale-105 transition-transform duration-300">
                    <div class="text-2xl mb-2">üî¥</div>
                    <div class="text-2xl font-bold text-white" id="inactiveApis">-</div>
                    <div class="text-gray-300 text-sm">Inactive APIs</div>
                </div>
                
                <div class="glass rounded-xl p-4 text-center hover:scale-105 transition-transform duration-300">
                    <div class="text-2xl mb-2">üì±</div>
                    <div class="text-2xl font-bold text-white" id="totalNumbers">-</div>
                    <div class="text-gray-300 text-sm">Numbers Used</div>
                </div>
            </div>
        </div>

        <!-- API List -->
        <div class="glass rounded-xl p-6">
            <div class="flex flex-col md:flex-row justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-white mb-4 md:mb-0">Configured APIs</h3>
                <div class="flex flex-col sm:flex-row gap-2">
                    <input type="text" id="apiSearch" placeholder="Search APIs..." class="px-4 py-2 rounded-lg bg-white/20 text-white placeholder-gray-300 border border-white/20 focus:outline-none focus:border-white/40">
                    <button onclick="refreshApis()" class="btn-secondary">
                        üîÑ Refresh
                    </button>
                </div>
            </div>
            
            <div id="apiList" class="api-list">
                <div class="text-center p-8 text-gray-400">Loading APIs...</div>
            </div>
        </div>
        
        <!-- Help Section -->
        <div class="glass rounded-xl p-6 mt-6">
            <h3 class="text-xl font-semibold text-white mb-4">üìö How to Configure Any SMS Service</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h4 class="text-lg font-semibold text-white mb-3">üîë URL Placeholders</h4>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div><code class="bg-white/10 px-2 py-1 rounded">{country}</code> - Country code (e.g., usa, russia)</div>
                        <div><code class="bg-white/10 px-2 py-1 rounded">{service}</code> - Service type (e.g., whatsapp, google)</div>
                        <div><code class="bg-white/10 px-2 py-1 rounded">{api_key}</code> - Your API key</div>
                        <div><code class="bg-white/10 px-2 py-1 rounded">{id}</code> - Order ID from response</div>
                        <div><code class="bg-white/10 px-2 py-1 rounded">{phone}</code> - Phone number from response</div>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold text-white mb-3">üîê Authentication Methods</h4>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div><strong>API Key in Header:</strong> X-API-Key: your_key</div>
                        <div><strong>API Key in URL:</strong> ?api_key=your_key</div>
                        <div><strong>Bearer Token:</strong> Authorization: Bearer your_token</div>
                        <div><strong>Basic Auth:</strong> Username/password</div>
                        <div><strong>Custom Header:</strong> Any header name you specify</div>
                    </div>
                </div>
            </div>
            
            <div class="mt-6">
                <h4 class="text-lg font-semibold text-white mb-3">üìã Response Path Examples</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-300">
                    <div>
                        <strong>JSON Response:</strong>
                        <pre class="bg-white/10 p-2 rounded mt-2 text-xs">
{
  "status": "success",
  "data": {
    "phone": "+1234567890",
    "id": "12345",
    "sms": [{"text": "OTP: 123456"}]
  }
}</pre>
                        <div class="mt-2">
                            <strong>Paths:</strong><br>
                            Phone: <code class="bg-white/10 px-1 rounded">data.phone</code><br>
                            ID: <code class="bg-white/10 px-1 rounded">data.id</code><br>
                            SMS: <code class="bg-white/10 px-1 rounded">data.sms.0.text</code>
                        </div>
                    </div>
                    
                    <div>
                        <strong>XML Response:</strong>
                        <pre class="bg-white/10 p-2 rounded mt-2 text-xs">
&lt;response&gt;
  &lt;status&gt;success&lt;/status&gt;
  &lt;phone&gt;+1234567890&lt;/phone&gt;
  &lt;id&gt;12345&lt;/id&gt;
  &lt;sms&gt;OTP: 123456&lt;/sms&gt;
&lt;/response&gt;</pre>
                        <div class="mt-2">
                            <strong>Paths:</strong><br>
                            Phone: <code class="bg-white/10 px-1 rounded">//phone</code><br>
                            ID: <code class="bg-white/10 px-1 rounded">//id</code><br>
                            SMS: <code class="bg-white/10 px-1 rounded">//sms</code>
                        </div>
                    </div>
                    
                    <div>
                        <strong>Text Response:</strong>
                        <pre class="bg-white/10 p-2 rounded mt-2 text-xs">
ACCESS_12345:1234567890</pre>
                        <div class="mt-2">
                            <strong>Parsing:</strong><br>
                            Use <code class="bg-white/10 px-1 rounded">startsWith</code> or <code class="bg-white/10 px-1 rounded">contains</code><br>
                            Status: <code class="bg-white/10 px-1 rounded">ACCESS_</code><br>
                            Extract ID and phone with regex
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 p-4 bg-white/10 rounded-lg">
                <h4 class="text-lg font-semibold text-white mb-3">üí° Pro Tips</h4>
                <ul class="text-sm text-gray-300 space-y-1">
                    <li>‚Ä¢ <strong>Test your URLs</strong> in a browser first to ensure they work</li>
                    <li>‚Ä¢ <strong>Use the example configurations</strong> as starting points</li>
                    <li>‚Ä¢ <strong>Check API documentation</strong> for exact response formats</li>
                    <li>‚Ä¢ <strong>Start with simple configurations</strong> and add complexity later</li>
                    <li>‚Ä¢ <strong>Use the test function</strong> to validate your setup</li>
                    <li>‚Ä¢ <strong>Monitor API responses</strong> to debug any issues</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- API Configuration Modal -->
    <div id="apiConfigModal" class="modal">
        <div class="modal-content mx-4 my-8 max-w-4xl w-full fade-in">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-semibold text-gray-800" id="modalTitle">üîå Add New API Configuration</h3>
                    <button onclick="closeApiConfigModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                
                <form id="apiConfigForm" onsubmit="handleApiConfigSubmit(event)">
                    <div class="form-grid">
                        <!-- Basic Configuration -->
                        <div class="form-section">
                            <h3>üîß Basic Configuration</h3>
                            
                            <div class="form-group">
                                <label class="form-label required">API Name</label>
                                <input type="text" id="apiName" name="apiName" required 
                                       class="form-input" placeholder="e.g., 5sim.net API">
                                <div class="help-text">Give your API configuration a descriptive name</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label required">Server</label>
                                <select id="serverId" name="serverId" required class="form-select">
                                    <option value="">Select a server</option>
                                </select>
                                <div class="help-text">Choose which server this API will be associated with</div>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="usesAuth" name="usesAuth" class="checkbox-input">
                                <label for="usesAuth" class="checkbox-label">API uses Authorization Header</label>
                            </div>
                        </div>

                        <!-- URL Configuration -->
                        <div class="form-section">
                            <h3>üîó URL Configuration</h3>
                            
                            <div class="form-group">
                                <label class="form-label required-field">Get Number URL</label>
                                <input type="url" id="getNumberUrl" name="getNumberUrl" required 
                                       class="form-input" placeholder="https://your-api.com/buy?country={country}&service={service}">
                                <div class="help-text">URL to request a new phone number. Use placeholders: {country}, {service}, {api_key}</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label required-field">Get Message Status URL</label>
                                <input type="url" id="getStatusUrl" name="getStatusUrl" required 
                                       class="form-input" placeholder="https://your-api.com/check/{id} or https://your-api.com/status?order={id}">
                                <div class="help-text">URL to check if OTP message has been received. Use {id} for order ID</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Activate Next Message URL</label>
                                <input type="url" id="activateUrl" name="activateUrl" 
                                       class="form-input" placeholder="https://your-api.com/finish/{id} or https://your-api.com/activate?order={id}">
                                <div class="help-text">URL to activate/confirm the next message (optional). Use {id} for order ID</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Cancel Number URL</label>
                                <input type="url" id="cancelUrl" name="cancelUrl" 
                                       class="form-input" placeholder="https://your-api.com/cancel/{id} or https://your-api.com/stop?order={id}">
                                <div class="help-text">URL to cancel the number if needed (optional). Use {id} for order ID</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Balance Check URL</label>
                                <input type="url" id="balanceUrl" name="balanceUrl" 
                                       class="form-input" placeholder="https://your-api.com/balance or https://your-api.com/account">
                                <div class="help-text">URL to check account balance (optional)</div>
                            </div>
                        </div>

                        <!-- Authentication Configuration -->
                        <div class="form-section">
                            <h3>üîê Authentication Configuration</h3>
                            
                            <div class="form-group">
                                <label class="form-label">Authentication Method</label>
                                <select id="authMethod" name="authMethod" class="form-select">
                                    <option value="none">No Authentication</option>
                                    <option value="api_key">API Key in Header</option>
                                    <option value="api_key_param">API Key in URL Parameter</option>
                                    <option value="bearer_token">Bearer Token</option>
                                    <option value="basic_auth">Basic Authentication</option>
                                    <option value="custom_header">Custom Header</option>
                                </select>
                                <div class="help-text">How your API handles authentication</div>
                            </div>
                            
                            <div class="form-group" id="apiKeyGroup" style="display: none;">
                                <label class="form-label">API Key/Token</label>
                                <input type="password" id="apiKey" name="apiKey" 
                                       class="form-input" placeholder="Your API key or token">
                                <div class="help-text">Your API authentication key</div>
                            </div>
                            
                            <div class="form-group" id="customHeaderGroup" style="display: none;">
                                <label class="form-label">Custom Header Name</label>
                                <input type="text" id="customHeaderName" name="customHeaderName" 
                                       class="form-input" placeholder="e.g., X-API-Key, Authorization">
                                <div class="help-text">Name of the custom header for authentication</div>
                            </div>
                            
                            <div class="form-group" id="usernameGroup" style="display: none;">
                                <label class="form-label">Username</label>
                                <input type="text" id="username" name="username" 
                                       class="form-input" placeholder="Your API username">
                                <div class="help-text">Username for basic authentication</div>
                            </div>
                            
                            <div class="form-group" id="passwordGroup" style="display: none;">
                                <label class="form-label">Password</label>
                                <input type="password" id="password" name="password" 
                                       class="form-input" placeholder="Your API password">
                                <div class="help-text">Password for basic authentication</div>
                            </div>
                        </div>

                        <!-- Response Configuration -->
                        <div class="form-section">
                            <h3>üìÑ Response Configuration</h3>
                            
                            <div class="form-group">
                                <label class="form-label required-field">API Response Type</label>
                                <select id="responseType" name="responseType" required class="form-select">
                                    <option value="text">Text</option>
                                    <option value="json">JSON</option>
                                    <option value="xml">XML</option>
                                    <option value="html">HTML</option>
                                </select>
                                <div class="help-text">Select the format of your API responses</div>
                            </div>
                            
                            <div class="form-group" id="jsonPathGroup" style="display: none;">
                                <label class="form-label">Message Text Path (JSON)</label>
                                <input type="text" id="messagePath" name="messagePath" 
                                       class="form-input" placeholder="e.g., data.message, sms.0.text, or response.sms.text">
                                <div class="help-text">JSON path to extract message text from response (use dot notation)</div>
                            </div>
                            
                            <div class="form-group" id="xmlPathGroup" style="display: none;">
                                <label class="form-label">Message Text Path (XML)</label>
                                <input type="text" id="xmlMessagePath" name="xmlMessagePath" 
                                       class="form-input" placeholder="e.g., //sms/text, //message, or /response/sms">
                                <div class="help-text">XPath to extract message text from XML response</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label required-field">Success Status Check</label>
                                <select id="statusCheckType" name="statusCheckType" required class="form-select">
                                    <option value="startsWith">Response starts with</option>
                                    <option value="contains">Response contains</option>
                                    <option value="equals">Response equals</option>
                                    <option value="jsonPath">JSON path check</option>
                                    <option value="xmlPath">XML path check</option>
                                    <option value="regex">Regular expression</option>
                                </select>
                                <div class="help-text">How to determine if the API call was successful</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label required-field">Success Status Value</label>
                                <input type="text" id="statusValue" name="statusValue" required 
                                       class="form-input" placeholder="e.g., STATUS_OK, success, 200, or ^success$">
                                <div class="help-text">The value that indicates a successful API response</div>
                            </div>
                            
                            <div class="form-group" id="statusPathGroup" style="display: none;">
                                <label class="form-label">Status Path</label>
                                <input type="text" id="statusPath" name="statusPath" 
                                       class="form-input" placeholder="e.g., status, result.status, or //status">
                                <div class="help-text">Path to status field in response (JSON path or XPath)</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Phone Number Path</label>
                                <input type="text" id="phonePath" name="phonePath" 
                                       class="form-input" placeholder="e.g., phone, number, or data.phone">
                                <div class="help-text">Path to extract phone number from response (optional)</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Order ID Path</label>
                                <input type="text" id="orderIdPath" name="orderIdPath" 
                                       class="form-input" placeholder="e.g., id, order_id, or data.id">
                                <div class="help-text">Path to extract order ID from response (optional)</div>
                            </div>
                        </div>

                        <!-- Request Configuration -->
                        <div class="form-section">
                            <h3>üì§ Request Configuration</h3>
                            
                            <div class="form-group">
                                <label class="form-label">Request Method</label>
                                <select id="requestMethod" name="requestMethod" class="form-select">
                                    <option value="GET">GET</option>
                                    <option value="POST">POST</option>
                                    <option value="PUT">PUT</option>
                                    <option value="PATCH">PATCH</option>
                                </select>
                                <div class="help-text">HTTP method for API requests</div>
                            </div>
                            
                            <div class="form-group" id="postDataGroup" style="display: none;">
                                <label class="form-label">POST Data Template</label>
                                <textarea id="postDataTemplate" name="postDataTemplate" 
                                          class="form-input" rows="3" 
                                          placeholder='{"country": "{country}", "service": "{service}", "api_key": "{api_key}"}'></textarea>
                                <div class="help-text">JSON template for POST requests. Use placeholders: {country}, {service}, {api_key}</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Additional Headers</label>
                                <textarea id="additionalHeaders" name="additionalHeaders" 
                                          class="form-input" rows="3" 
                                          placeholder='{"User-Agent": "OTP-Bot/1.0", "Accept": "application/json"}'></textarea>
                                <div class="help-text">Additional HTTP headers as JSON (optional)</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Request Timeout (seconds)</label>
                                <input type="number" id="requestTimeout" name="requestTimeout" 
                                       class="form-input" placeholder="30" min="5" max="300" value="30">
                                <div class="help-text">Maximum time to wait for API response</div>
                            </div>
                        </div>

                        <!-- Advanced Configuration -->
                        <div class="form-section">
                            <h3>‚öôÔ∏è Advanced Configuration</h3>
                            
                            <div class="form-group">
                                <label class="form-label">Auto Cancel Number (minutes)</label>
                                <input type="number" id="autoCancelMinutes" name="autoCancelMinutes" 
                                       class="form-input" placeholder="10" min="1" max="60">
                                <div class="help-text">Automatically cancel number after specified minutes (optional)</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Retry Get Number (times)</label>
                                <input type="number" id="retryCount" name="retryCount" 
                                       class="form-input" placeholder="3" min="1" max="10">
                                <div class="help-text">Number of times to retry getting a number if failed</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Rate Limit (requests per minute)</label>
                                <input type="number" id="rateLimit" name="rateLimit" 
                                       class="form-input" placeholder="10" min="1" max="100" value="10">
                                <div class="help-text">Maximum API requests per minute to avoid rate limiting</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Service Priority</label>
                                <select id="servicePriority" name="servicePriority" class="form-select">
                                    <option value="1">1 - Highest</option>
                                    <option value="2">2 - High</option>
                                    <option value="3" selected>3 - Normal</option>
                                    <option value="4">4 - Low</option>
                                    <option value="5">5 - Lowest</option>
                                </select>
                                <div class="help-text">Priority when multiple APIs are available for the same service</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Enable Service</label>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="isEnabled" name="isEnabled" class="checkbox-input" checked>
                                    <label for="isEnabled" class="checkbox-label">This API configuration is active and ready to use</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex gap-3 mt-6">
                        <button type="submit" class="btn-primary flex-1">
                            <span id="submitButtonText">üöÄ Add API Configuration</span>
                        </button>
                        <button type="button" onclick="closeApiConfigModal()" class="btn-secondary flex-1">
                            ‚ùå Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Test API Modal -->
    <div id="testApiModal" class="modal">
        <div class="modal-content mx-4 my-8 max-w-2xl w-full fade-in">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold text-gray-800">Test API Connection</h3>
                    <button onclick="closeTestModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                
                <div id="testResults" class="space-y-4">
                    <div class="text-center">
                        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"></div>
                        <p class="mt-2 text-gray-600">Testing API connection...</p>
                    </div>
                </div>
                
                <div class="flex gap-3 mt-6">
                    <button onclick="closeTestModal()" class="btn-secondary flex-1">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let apis = [];
        let servers = [];
        let editingApiId = null;
        let testingApiId = null;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('API Configuration page loaded');
            
            try {
                loadApis();
                loadServers();
                setupSearch();
                setupFormHandlers();
                console.log('Page initialization completed successfully');
            } catch (error) {
                console.error('Error during page initialization:', error);
                showError('Error initializing page: ' + error.message);
            }
        });

        // Load APIs from server
        async function loadApis() {
            try {
                const response = await fetch('/api/apis');
                if (response.ok) {
                    apis = await response.json();
                    updateApiList();
                    updateApiStats();
                } else {
                    console.error('Failed to load APIs');
                    showError('Failed to load APIs');
                }
            } catch (error) {
                console.error('Error loading APIs:', error);
                showError('Error loading APIs');
            }
        }

        // Load servers for dropdown
        async function loadServers() {
            try {
                const response = await fetch('/api/servers');
                if (response.ok) {
                    servers = await response.json();
                    updateServerDropdown();
                } else {
                    console.error('Failed to load servers');
                }
            } catch (error) {
                console.error('Error loading servers:', error);
            }
        }

        // Update API list display
        function updateApiList() {
            const apiList = document.getElementById('apiList');
            if (apis.length === 0) {
                apiList.innerHTML = '<div class="text-center p-8 text-gray-400">No APIs configured yet</div>';
                return;
            }

            apiList.innerHTML = apis.map(api => `
                <div class="api-card">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-2">
                                <h4 class="text-lg font-semibold text-white">${api.name}</h4>
                                <span class="api-status ${getStatusClass(api.status)}">
                                    ${getStatusIcon(api.status)} ${api.status}
                                </span>
                            </div>
                            <p class="text-gray-300 text-sm mb-2">Server: ${getServerName(api.serverId)}</p>
                            <p class="text-gray-300 text-sm">Response Type: ${api.responseType.toUpperCase()}</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="testApi('${api._id}')" class="btn-secondary text-sm">
                                üß™ Test
                            </button>
                            <button onclick="editApi('${api._id}')" class="btn-secondary text-sm">
                                ‚úèÔ∏è Edit
                            </button>
                            <button onclick="deleteApi('${api._id}')" class="btn-secondary text-sm bg-red-500/20 text-red-300 border-red-500/30">
                                üóëÔ∏è Delete
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Update API statistics
        function updateApiStats() {
            document.getElementById('totalApis').textContent = apis.length;
            document.getElementById('activeApis').textContent = apis.filter(a => a.status === 'active').length;
            document.getElementById('inactiveApis').textContent = apis.filter(a => a.status === 'inactive').length;
            document.getElementById('totalNumbers').textContent = apis.reduce((sum, api) => sum + (api.numbersUsed || 0), 0);
        }

        // Update server dropdown
        function updateServerDropdown() {
            const serverSelect = document.getElementById('serverId');
            serverSelect.innerHTML = '<option value="">Select a server</option>' + 
                servers.map(server => `<option value="${server._id}">${server.name} (${server.code})</option>`).join('');
        }

        // Get server name by ID
        function getServerName(serverId) {
            const server = servers.find(s => s._id === serverId);
            return server ? server.name : 'Unknown Server';
        }

        // Get status class for styling
        function getStatusClass(status) {
            switch (status) {
                case 'active': return 'status-active';
                case 'inactive': return 'status-inactive';
                case 'testing': return 'status-testing';
                default: return 'status-inactive';
            }
        }

        // Get status icon
        function getStatusIcon(status) {
            switch (status) {
                case 'active': return 'üü¢';
                case 'inactive': return 'üî¥';
                case 'testing': return 'üü°';
                default: return '‚ö™';
            }
        }

        // Setup search functionality
        function setupSearch() {
            const searchInput = document.getElementById('apiSearch');
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const filteredApis = apis.filter(api => 
                    api.name.toLowerCase().includes(searchTerm) ||
                    getServerName(api.serverId).toLowerCase().includes(searchTerm)
                );
                updateApiListWithData(filteredApis);
            });
        }

        // Update list with filtered data
        function updateApiListWithData(apiData) {
            const apiList = document.getElementById('apiList');
            if (apiData.length === 0) {
                apiList.innerHTML = '<div class="text-center p-8 text-gray-400">No APIs found</div>';
                return;
            }

            apiList.innerHTML = apiData.map(api => `
                <div class="api-card">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-2">
                                <h4 class="text-lg font-semibold text-white">${api.name}</h4>
                                <span class="api-status ${getStatusClass(api.status)}">
                                    ${getStatusIcon(api.status)} ${api.status}
                                </span>
                            </div>
                            <p class="text-gray-300 text-sm mb-2">Server: ${getServerName(api.serverId)}</p>
                            <p class="text-gray-300 text-sm">Response Type: ${api.responseType.toUpperCase()}</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="testApi('${api._id}')" class="btn-secondary text-sm">
                                üß™ Test
                            </button>
                            <button onclick="editApi('${api._id}')" class="btn-secondary text-sm">
                                ‚úèÔ∏è Edit
                            </button>
                            <button onclick="deleteApi('${api._id}')" class="btn-secondary text-sm bg-red-500/20 text-red-300 border-red-500/30">
                                üóëÔ∏è Delete
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Setup form handlers
        function setupFormHandlers() {
            const responseType = document.getElementById('responseType');
            const jsonPathGroup = document.getElementById('jsonPathGroup');
            const xmlPathGroup = document.getElementById('xmlPathGroup');
            const statusCheckType = document.getElementById('statusCheckType');
            const statusPathGroup = document.getElementById('statusPathGroup');
            const authMethod = document.getElementById('authMethod');
            const apiKeyGroup = document.getElementById('apiKeyGroup');
            const customHeaderGroup = document.getElementById('customHeaderGroup');
            const usernameGroup = document.getElementById('usernameGroup');
            const passwordGroup = document.getElementById('passwordGroup');
            const postDataGroup = document.getElementById('postDataGroup');
            const requestMethod = document.getElementById('requestMethod');
            const autoCancelMinutes = document.getElementById('autoCancelMinutes');
            const retryCount = document.getElementById('retryCount');
            const rateLimit = document.getElementById('rateLimit');
            const servicePriority = document.getElementById('servicePriority');
            const isEnabled = document.getElementById('isEnabled');

            responseType.addEventListener('change', function() {
                if (this.value === 'json') {
                    jsonPathGroup.style.display = 'block';
                    xmlPathGroup.style.display = 'none';
                } else if (this.value === 'xml') {
                    jsonPathGroup.style.display = 'none';
                    xmlPathGroup.style.display = 'block';
                } else {
                    jsonPathGroup.style.display = 'none';
                    xmlPathGroup.style.display = 'none';
                }
            });

            statusCheckType.addEventListener('change', function() {
                if (this.value === 'jsonPath') {
                    statusPathGroup.style.display = 'block';
                } else if (this.value === 'xmlPath') {
                    statusPathGroup.style.display = 'block';
                } else {
                    statusPathGroup.style.display = 'none';
                }
            });

            authMethod.addEventListener('change', function() {
                if (this.value === 'api_key') {
                    apiKeyGroup.style.display = 'block';
                    customHeaderGroup.style.display = 'none';
                    usernameGroup.style.display = 'none';
                    passwordGroup.style.display = 'none';
                } else if (this.value === 'api_key_param') {
                    apiKeyGroup.style.display = 'block';
                    customHeaderGroup.style.display = 'none';
                    usernameGroup.style.display = 'none';
                    passwordGroup.style.display = 'none';
                } else if (this.value === 'bearer_token') {
                    apiKeyGroup.style.display = 'none';
                    customHeaderGroup.style.display = 'none';
                    usernameGroup.style.display = 'none';
                    passwordGroup.style.display = 'none';
                } else if (this.value === 'basic_auth') {
                    apiKeyGroup.style.display = 'none';
                    customHeaderGroup.style.display = 'none';
                    usernameGroup.style.display = 'block';
                    passwordGroup.style.display = 'block';
                } else if (this.value === 'custom_header') {
                    apiKeyGroup.style.display = 'none';
                    customHeaderGroup.style.display = 'block';
                    usernameGroup.style.display = 'none';
                    passwordGroup.style.display = 'none';
                } else {
                    apiKeyGroup.style.display = 'none';
                    customHeaderGroup.style.display = 'none';
                    usernameGroup.style.display = 'none';
                    passwordGroup.style.display = 'none';
                }
            });

            requestMethod.addEventListener('change', function() {
                if (this.value === 'POST') {
                    postDataGroup.style.display = 'block';
                } else {
                    postDataGroup.style.display = 'none';
                }
            });

            autoCancelMinutes.addEventListener('input', function() {
                if (this.value === '') this.value = '0';
            });

            retryCount.addEventListener('input', function() {
                if (this.value === '') this.value = '0';
            });

            rateLimit.addEventListener('input', function() {
                if (this.value === '') this.value = '0';
            });

            servicePriority.addEventListener('change', function() {
                if (this.value === '') this.value = '3'; // Default to 3 if no option is selected
            });

            isEnabled.addEventListener('change', function() {
                if (this.checked) {
                    this.closest('.form-group').querySelector('.checkbox-label').textContent = 'This API configuration is active and ready to use';
                } else {
                    this.closest('.form-group').querySelector('.checkbox-label').textContent = 'This API configuration is inactive';
                }
            });
        }

        // Open API config modal
        function openApiConfigModal() {
            try {
                console.log('Opening API config modal...');
                
                editingApiId = null;
                
                const modalTitle = document.getElementById('modalTitle');
                const submitButtonText = document.getElementById('submitButtonText');
                const apiConfigForm = document.getElementById('apiConfigForm');
                const apiConfigModal = document.getElementById('apiConfigModal');
                
                if (!modalTitle || !submitButtonText || !apiConfigForm || !apiConfigModal) {
                    console.error('Required modal elements not found:', {
                        modalTitle: !!modalTitle,
                        submitButtonText: !!submitButtonText,
                        apiConfigForm: !!apiConfigForm,
                        apiConfigModal: !!apiConfigModal
                    });
                    showError('Modal elements not found. Please refresh the page.');
                    return;
                }
                
                modalTitle.textContent = 'Add New API Configuration';
                submitButtonText.textContent = 'Add API Configuration';
                apiConfigForm.reset();
                
                // Reset dynamic fields - only access elements that exist
                const jsonPathGroup = document.getElementById('jsonPathGroup');
                const xmlPathGroup = document.getElementById('xmlPathGroup');
                const statusPathGroup = document.getElementById('statusPathGroup');
                const postDataGroup = document.getElementById('postDataGroup');
                
                if (jsonPathGroup) jsonPathGroup.style.display = 'none';
                if (xmlPathGroup) xmlPathGroup.style.display = 'none';
                if (statusPathGroup) statusPathGroup.style.display = 'none';
                if (postDataGroup) postDataGroup.style.display = 'none';
                
                // Reset form values - only access elements that exist
                const autoCancelMinutes = document.getElementById('autoCancelMinutes');
                const retryCount = document.getElementById('retryCount');
                const rateLimit = document.getElementById('rateLimit');
                const servicePriority = document.getElementById('servicePriority');
                const isEnabled = document.getElementById('isEnabled');
                
                if (autoCancelMinutes) autoCancelMinutes.value = '0';
                if (retryCount) retryCount.value = '0';
                if (rateLimit) rateLimit.value = '10';
                if (servicePriority) servicePriority.value = '3';
                if (isEnabled) isEnabled.checked = true;

                apiConfigModal.style.display = 'block';
                console.log('Modal opened successfully');
                
            } catch (error) {
                console.error('Error opening modal:', error);
                showError('Error opening modal: ' + error.message);
            }
        }

        // Edit API
        function editApi(apiId) {
            const api = apis.find(a => a._id === apiId);
            if (!api) return;

            editingApiId = apiId;
            document.getElementById('modalTitle').textContent = 'Edit API Configuration';
            document.getElementById('submitButtonText').textContent = 'Update API Configuration';
            
            // Populate form fields - only access elements that exist
            const apiName = document.getElementById('apiName');
            const serverId = document.getElementById('serverId');
            const usesAuth = document.getElementById('usesAuth');
            const responseType = document.getElementById('responseType');
            const messagePath = document.getElementById('messagePath');
            const statusCheckType = document.getElementById('statusCheckType');
            const statusValue = document.getElementById('statusValue');
            const getNumberUrl = document.getElementById('getNumberUrl');
            const getStatusUrl = document.getElementById('getStatusUrl');
            const activateUrl = document.getElementById('activateUrl');
            const cancelUrl = document.getElementById('cancelUrl');
            const balanceUrl = document.getElementById('balanceUrl');
            const autoCancelMinutes = document.getElementById('autoCancelMinutes');
            const retryCount = document.getElementById('retryCount');
            const rateLimit = document.getElementById('rateLimit');
            const servicePriority = document.getElementById('servicePriority');
            const isEnabled = document.getElementById('isEnabled');
            
            if (apiName) apiName.value = api.name;
            if (serverId) serverId.value = api.serverId;
            if (usesAuth) usesAuth.checked = api.usesAuth || false;
            if (responseType) responseType.value = api.responseType;
            if (messagePath) messagePath.value = api.messagePath || '';
            if (statusCheckType) statusCheckType.value = api.statusCheckType;
            if (statusValue) statusValue.value = api.statusValue;
            if (getNumberUrl) getNumberUrl.value = api.getNumberUrl;
            if (getStatusUrl) getStatusUrl.value = api.getStatusUrl;
            if (activateUrl) activateUrl.value = api.activateUrl || '';
            if (cancelUrl) cancelUrl.value = api.cancelUrl || '';
            if (balanceUrl) balanceUrl.value = api.balanceUrl || '';
            if (autoCancelMinutes) autoCancelMinutes.value = api.autoCancelMinutes || '0';
            if (retryCount) retryCount.value = api.retryCount || '0';
            if (rateLimit) rateLimit.value = api.rateLimit || '10';
            if (servicePriority) servicePriority.value = api.servicePriority || '3';
            if (isEnabled) isEnabled.checked = api.isEnabled || false;

            // Show/hide JSON path group
            const jsonPathGroup = document.getElementById('jsonPathGroup');
            const xmlPathGroup = document.getElementById('xmlPathGroup');
            const statusPathGroup = document.getElementById('statusPathGroup');
            const postDataGroup = document.getElementById('postDataGroup');
            
            if (api.responseType === 'json') {
                if (jsonPathGroup) jsonPathGroup.style.display = 'block';
                if (xmlPathGroup) xmlPathGroup.style.display = 'none';
            } else if (api.responseType === 'xml') {
                if (jsonPathGroup) jsonPathGroup.style.display = 'none';
                if (xmlPathGroup) xmlPathGroup.style.display = 'block';
            } else {
                if (jsonPathGroup) jsonPathGroup.style.display = 'none';
                if (xmlPathGroup) xmlPathGroup.style.display = 'none';
            }

            // Show/hide status path group
            if (api.statusCheckType === 'jsonPath' || api.statusCheckType === 'xmlPath') {
                if (statusPathGroup) statusPathGroup.style.display = 'block';
            } else {
                if (statusPathGroup) statusPathGroup.style.display = 'none';
            }

            // Show/hide POST data group
            if (api.requestMethod === 'POST') {
                if (postDataGroup) postDataGroup.style.display = 'block';
            } else {
                if (postDataGroup) postDataGroup.style.display = 'none';
            }

            document.getElementById('apiConfigModal').style.display = 'block';
        }

        // Handle API config form submission
        async function handleApiConfigSubmit(event) {
            event.preventDefault();
            
            try {
                const formData = new FormData(event.target);
                const apiData = {
                    name: formData.get('apiName'),
                    serverId: formData.get('serverId'),
                    usesAuth: formData.get('usesAuth') === 'on',
                    responseType: formData.get('responseType'),
                    messagePath: formData.get('messagePath'),
                    statusCheckType: formData.get('statusCheckType'),
                    statusValue: formData.get('statusValue'),
                    getNumberUrl: formData.get('getNumberUrl'),
                    getStatusUrl: formData.get('getStatusUrl'),
                    activateUrl: formData.get('activateUrl'),
                    cancelUrl: formData.get('cancelUrl'),
                    balanceUrl: formData.get('balanceUrl'),
                    autoCancelMinutes: formData.get('autoCancelMinutes') ? parseInt(formData.get('autoCancelMinutes')) : 0,
                    retryCount: formData.get('retryCount') ? parseInt(formData.get('retryCount')) : 0,
                    rateLimit: formData.get('rateLimit') ? parseInt(formData.get('rateLimit')) : 10,
                    servicePriority: formData.get('servicePriority') ? parseInt(formData.get('servicePriority')) : 3,
                    isEnabled: formData.get('isEnabled') === 'on',
                    apiKey: formData.get('apiKey'),
                    customHeaderName: formData.get('customHeaderName'),
                    username: formData.get('username'),
                    password: formData.get('password'),
                    requestMethod: formData.get('requestMethod'),
                    postDataTemplate: formData.get('postDataTemplate'),
                    additionalHeaders: formData.get('additionalHeaders'),
                    requestTimeout: formData.get('requestTimeout') ? parseInt(formData.get('requestTimeout')) : 30,
                    status: 'inactive'
                };

                // Validate required fields
                if (!apiData.name || !apiData.serverId || !apiData.getNumberUrl || !apiData.getStatusUrl) {
                    showError('Please fill in all required fields');
                    return;
                }

                const url = editingApiId ? `/api/apis/${editingApiId}` : '/api/apis';
                const method = editingApiId ? 'PUT' : 'POST';
                
                const response = await fetch(url, {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(apiData)
                });

                if (response.ok) {
                    closeApiConfigModal();
                    loadApis();
                    showSuccess(editingApiId ? 'API configuration updated successfully!' : 'API configuration added successfully!');
                } else {
                    const error = await response.json();
                    showError(error.message || 'Failed to save API configuration');
                }
            } catch (error) {
                console.error('Error saving API configuration:', error);
                showError('Error saving API configuration: ' + error.message);
            }
        }

        // Test API
        async function testApi(apiId) {
            testingApiId = apiId;
            document.getElementById('testApiModal').style.display = 'block';
            
            try {
                const response = await fetch(`/api/apis/${apiId}/test`, {
                    method: 'POST'
                });
                
                const result = await response.json();
                
                document.getElementById('testResults').innerHTML = `
                    <div class="space-y-4">
                        <div class="text-center">
                            <div class="text-2xl mb-2">${result.success ? '‚úÖ' : '‚ùå'}</div>
                            <h4 class="font-semibold text-gray-800">${result.success ? 'Test Successful' : 'Test Failed'}</h4>
                            <p class="text-gray-600">${result.message}</p>
                        </div>
                        ${result.details ? `
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h5 class="font-medium text-gray-800 mb-2">Test Details:</h5>
                                <pre class="text-sm text-gray-600 overflow-x-auto">${JSON.stringify(result.details, null, 2)}</pre>
                            </div>
                        ` : ''}
                    </div>
                `;
            } catch (error) {
                document.getElementById('testResults').innerHTML = `
                    <div class="text-center">
                        <div class="text-2xl mb-2">‚ùå</div>
                        <h4 class="font-semibold text-gray-800">Test Failed</h4>
                        <p class="text-gray-600">Error: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Delete API
        function deleteApi(apiId) {
            if (confirm('Are you sure you want to delete this API configuration? This action cannot be undone.')) {
                fetch(`/api/apis/${apiId}`, {
                    method: 'DELETE'
                }).then(response => {
                    if (response.ok) {
                        loadApis();
                        showSuccess('API configuration deleted successfully!');
                    } else {
                        showError('Failed to delete API configuration');
                    }
                }).catch(error => {
                    console.error('Error deleting API:', error);
                    showError('Error deleting API configuration');
                });
            }
        }

        // Close modals
        function closeApiConfigModal() {
            document.getElementById('apiConfigModal').style.display = 'none';
            editingApiId = null;
        }

        function closeTestModal() {
            document.getElementById('testApiModal').style.display = 'none';
            testingApiId = null;
        }

        // Refresh APIs
        function refreshApis() {
            loadApis();
        }



        // Utility functions
        function showSuccess(message) {
            alert(message);
        }

        function showError(message) {
            alert('Error: ' + message);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const apiConfigModal = document.getElementById('apiConfigModal');
            const testApiModal = document.getElementById('testApiModal');
            
            if (event.target === apiConfigModal) {
                closeApiConfigModal();
            }
            if (event.target === testApiModal) {
                closeTestModal();
            }
        }
    </script>
</body>
</html>
